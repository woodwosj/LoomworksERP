/**
 * Recharts - Shim for Loomworks Dashboard
 *
 * Recharts v2+ does not provide an official UMD browser bundle, so this shim
 * deliberately leaves `window.Recharts` undefined.  The dashboard chart widgets
 * detect the absence and render a CSS-based FallbackChart instead, which covers
 * line, bar, area, and pie chart types without requiring Recharts at all.
 *
 * If you want full Recharts rendering, you have two options:
 *
 *   Option A - Use the legacy v1.x UMD build (limited API surface):
 *     1. Ensure React 18 and ReactDOM 18 are loaded (provided by loomworks_spreadsheet).
 *     2. Load prop-types UMD:  https://unpkg.com/prop-types/prop-types.min.js
 *     3. Load recharts v1.8.6: https://unpkg.com/recharts@1.8.6/umd/Recharts.min.js
 *     This registers window.Recharts and chart widgets will use it automatically.
 *
 *   Option B - Build a custom UMD bundle from recharts v2.x source:
 *     1. Clone https://github.com/recharts/recharts
 *     2. Use webpack/rollup to produce a UMD bundle with React externalized
 *     3. Place the output here as recharts.min.js
 *
 * For most deployments the CSS fallback provides a good user experience and
 * avoids the ~500KB Recharts + D3 dependency chain.
 *
 * Version expected: >= 2.x (if loaded externally)
 * License: MIT (Recharts), LGPL-3 (this shim file)
 */
(function() {
    'use strict';

    // If Recharts was already loaded by another script, do nothing.
    if (typeof window.Recharts !== 'undefined') {
        return;
    }

    // Log a single informational message at startup.  The dashboard chart
    // widgets will use the CSS FallbackChart renderer automatically.
    var warned = false;
    function warnOnce() {
        if (warned) return;
        warned = true;
        console.info(
            'Loomworks Dashboard: Recharts library is not loaded. ' +
            'Chart widgets will render using the built-in CSS fallback renderer. ' +
            'This is normal for default installations.'
        );
    }

    // Fire on first access from any component that checks for Recharts.
    // We intentionally do NOT set window.Recharts so that ChartWidget.jsx
    // detects `typeof Recharts === "undefined"` and routes to FallbackChart.
    //
    // However, we log a one-time informational notice when the dashboard JS
    // initializes.  Use requestAnimationFrame to defer until after page load.
    if (typeof requestAnimationFrame === 'function') {
        requestAnimationFrame(warnOnce);
    } else {
        setTimeout(warnOnce, 0);
    }
})();
