/**
 * DashboardCanvas - Gridstack-based dashboard canvas
 *
 * Uses Gridstack.js for drag-drop widget placement and resizing.
 * Renders widget components inside the grid items.
 */

const {
  useState,
  useEffect,
  useRef,
  useCallback
} = React;

// Widget component mapping
const WIDGET_COMPONENTS = {
  kpi: 'KPIWidget',
  chart_line: 'ChartWidget',
  chart_bar: 'ChartWidget',
  chart_area: 'ChartWidget',
  chart_pie: 'ChartWidget',
  table: 'TableWidget',
  filter: 'FilterWidget',
  gauge: 'GaugeWidget'
};
function DashboardCanvas({
  widgets,
  widgetData,
  filters,
  mode,
  layoutColumns = 12,
  onWidgetChange,
  onWidgetSelect,
  onWidgetAction,
  onDeleteWidget
}) {
  const gridRef = useRef(null);
  const gridInstanceRef = useRef(null);

  // Initialize Gridstack
  useEffect(() => {
    if (!gridRef.current || gridInstanceRef.current) return;

    // Check if GridStack is available
    if (typeof GridStack === 'undefined') {
      console.error('GridStack not loaded');
      return;
    }

    // Initialize grid
    const grid = GridStack.init({
      column: layoutColumns,
      cellHeight: 80,
      minRow: 1,
      float: true,
      animate: true,
      resizable: {
        handles: mode === 'edit' ? 'e, se, s, sw, w' : ''
      },
      draggable: {
        handle: '.lw-widget-header'
      },
      disableDrag: mode !== 'edit',
      disableResize: mode !== 'edit'
    }, gridRef.current);
    gridInstanceRef.current = grid;

    // Handle widget movement
    grid.on('dragstop', (event, el) => {
      const node = el.gridstackNode;
      if (node && onWidgetChange) {
        onWidgetChange(node.id, {
          position: {
            x: node.x,
            y: node.y
          }
        });
      }
    });

    // Handle widget resize
    grid.on('resizestop', (event, el) => {
      const node = el.gridstackNode;
      if (node && onWidgetChange) {
        onWidgetChange(node.id, {
          size: {
            w: node.w,
            h: node.h
          }
        });
      }
    });
    return () => {
      if (gridInstanceRef.current) {
        gridInstanceRef.current.destroy(false);
        gridInstanceRef.current = null;
      }
    };
  }, [layoutColumns, mode]);

  // Update grid mode (edit/view)
  useEffect(() => {
    if (!gridInstanceRef.current) return;
    const grid = gridInstanceRef.current;
    if (mode === 'edit') {
      grid.enableMove(true);
      grid.enableResize(true);
    } else {
      grid.enableMove(false);
      grid.enableResize(false);
    }
  }, [mode]);

  // Render widget content
  const renderWidgetContent = useCallback(widget => {
    const data = widgetData[widget.id];
    const componentName = WIDGET_COMPONENTS[widget.type] || 'KPIWidget';
    const props = {
      widget,
      data,
      filters,
      mode,
      onAction: onWidgetAction
    };

    // Use the globally registered widget components
    switch (componentName) {
      case 'KPIWidget':
        return /*#__PURE__*/React.createElement(KPIWidget, props);
      case 'ChartWidget':
        return /*#__PURE__*/React.createElement(ChartWidget, props);
      case 'TableWidget':
        return /*#__PURE__*/React.createElement(TableWidget, props);
      case 'FilterWidget':
        return /*#__PURE__*/React.createElement(FilterWidget, props);
      case 'GaugeWidget':
        return /*#__PURE__*/React.createElement(GaugeWidget, props);
      default:
        return /*#__PURE__*/React.createElement("div", {
          className: "lw-widget-placeholder"
        }, "Unknown widget type");
    }
  }, [widgetData, filters, mode, onWidgetAction]);
  return /*#__PURE__*/React.createElement("div", {
    className: "lw-dashboard-canvas"
  }, /*#__PURE__*/React.createElement("div", {
    className: "grid-stack",
    ref: gridRef
  }, widgets.map(widget => /*#__PURE__*/React.createElement("div", {
    key: widget.id,
    className: "grid-stack-item",
    "gs-id": widget.id,
    "gs-x": widget.position?.x || 0,
    "gs-y": widget.position?.y || 0,
    "gs-w": widget.size?.w || 4,
    "gs-h": widget.size?.h || 3,
    "gs-min-w": widget.minSize?.w || 2,
    "gs-min-h": widget.minSize?.h || 2
  }, /*#__PURE__*/React.createElement("div", {
    className: "grid-stack-item-content"
  }, /*#__PURE__*/React.createElement("div", {
    className: `lw-widget ${mode === 'edit' ? 'lw-widget-editable' : ''}`,
    onClick: () => onWidgetSelect && onWidgetSelect(widget.id)
  }, /*#__PURE__*/React.createElement("div", {
    className: "lw-widget-header"
  }, /*#__PURE__*/React.createElement("span", {
    className: "lw-widget-title"
  }, widget.name), mode === 'edit' && /*#__PURE__*/React.createElement("div", {
    className: "lw-widget-actions"
  }, /*#__PURE__*/React.createElement("button", {
    className: "lw-widget-action-btn",
    onClick: e => {
      e.stopPropagation();
      onWidgetSelect && onWidgetSelect(widget.id);
    },
    title: "Settings"
  }, /*#__PURE__*/React.createElement("i", {
    className: "fa fa-cog"
  })), /*#__PURE__*/React.createElement("button", {
    className: "lw-widget-action-btn lw-widget-action-delete",
    onClick: e => {
      e.stopPropagation();
      onDeleteWidget && onDeleteWidget(widget.id);
    },
    title: "Delete"
  }, /*#__PURE__*/React.createElement("i", {
    className: "fa fa-trash"
  })))), /*#__PURE__*/React.createElement("div", {
    className: "lw-widget-body"
  }, renderWidgetContent(widget))))))), widgets.length === 0 && /*#__PURE__*/React.createElement("div", {
    className: "lw-dashboard-empty"
  }, /*#__PURE__*/React.createElement("i", {
    className: "fa fa-tachometer fa-4x text-muted"
  }), /*#__PURE__*/React.createElement("h4", null, "No widgets yet"), /*#__PURE__*/React.createElement("p", {
    className: "text-muted"
  }, mode === 'edit' ? 'Click "Add Widget" to get started' : 'This dashboard is empty')));
}

// Export for use in DashboardApp
window.DashboardCanvas = DashboardCanvas;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ1c2VTdGF0ZSIsInVzZUVmZmVjdCIsInVzZVJlZiIsInVzZUNhbGxiYWNrIiwiUmVhY3QiLCJXSURHRVRfQ09NUE9ORU5UUyIsImtwaSIsImNoYXJ0X2xpbmUiLCJjaGFydF9iYXIiLCJjaGFydF9hcmVhIiwiY2hhcnRfcGllIiwidGFibGUiLCJmaWx0ZXIiLCJnYXVnZSIsIkRhc2hib2FyZENhbnZhcyIsIndpZGdldHMiLCJ3aWRnZXREYXRhIiwiZmlsdGVycyIsIm1vZGUiLCJsYXlvdXRDb2x1bW5zIiwib25XaWRnZXRDaGFuZ2UiLCJvbldpZGdldFNlbGVjdCIsIm9uV2lkZ2V0QWN0aW9uIiwib25EZWxldGVXaWRnZXQiLCJncmlkUmVmIiwiZ3JpZEluc3RhbmNlUmVmIiwiY3VycmVudCIsIkdyaWRTdGFjayIsImNvbnNvbGUiLCJlcnJvciIsImdyaWQiLCJpbml0IiwiY29sdW1uIiwiY2VsbEhlaWdodCIsIm1pblJvdyIsImZsb2F0IiwiYW5pbWF0ZSIsInJlc2l6YWJsZSIsImhhbmRsZXMiLCJkcmFnZ2FibGUiLCJoYW5kbGUiLCJkaXNhYmxlRHJhZyIsImRpc2FibGVSZXNpemUiLCJvbiIsImV2ZW50IiwiZWwiLCJub2RlIiwiZ3JpZHN0YWNrTm9kZSIsImlkIiwicG9zaXRpb24iLCJ4IiwieSIsInNpemUiLCJ3IiwiaCIsImRlc3Ryb3kiLCJlbmFibGVNb3ZlIiwiZW5hYmxlUmVzaXplIiwicmVuZGVyV2lkZ2V0Q29udGVudCIsIndpZGdldCIsImRhdGEiLCJjb21wb25lbnROYW1lIiwidHlwZSIsInByb3BzIiwib25BY3Rpb24iLCJjcmVhdGVFbGVtZW50IiwiS1BJV2lkZ2V0IiwiQ2hhcnRXaWRnZXQiLCJUYWJsZVdpZGdldCIsIkZpbHRlcldpZGdldCIsIkdhdWdlV2lkZ2V0IiwiY2xhc3NOYW1lIiwicmVmIiwibWFwIiwia2V5IiwibWluU2l6ZSIsIm9uQ2xpY2siLCJuYW1lIiwiZSIsInN0b3BQcm9wYWdhdGlvbiIsInRpdGxlIiwibGVuZ3RoIiwid2luZG93Il0sInNvdXJjZXMiOlsiLi4vcmVhY3QvRGFzaGJvYXJkQ2FudmFzLmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERhc2hib2FyZENhbnZhcyAtIEdyaWRzdGFjay1iYXNlZCBkYXNoYm9hcmQgY2FudmFzXG4gKlxuICogVXNlcyBHcmlkc3RhY2suanMgZm9yIGRyYWctZHJvcCB3aWRnZXQgcGxhY2VtZW50IGFuZCByZXNpemluZy5cbiAqIFJlbmRlcnMgd2lkZ2V0IGNvbXBvbmVudHMgaW5zaWRlIHRoZSBncmlkIGl0ZW1zLlxuICovXG5cbmNvbnN0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VDYWxsYmFjayB9ID0gUmVhY3Q7XG5cbi8vIFdpZGdldCBjb21wb25lbnQgbWFwcGluZ1xuY29uc3QgV0lER0VUX0NPTVBPTkVOVFMgPSB7XG4gICAga3BpOiAnS1BJV2lkZ2V0JyxcbiAgICBjaGFydF9saW5lOiAnQ2hhcnRXaWRnZXQnLFxuICAgIGNoYXJ0X2JhcjogJ0NoYXJ0V2lkZ2V0JyxcbiAgICBjaGFydF9hcmVhOiAnQ2hhcnRXaWRnZXQnLFxuICAgIGNoYXJ0X3BpZTogJ0NoYXJ0V2lkZ2V0JyxcbiAgICB0YWJsZTogJ1RhYmxlV2lkZ2V0JyxcbiAgICBmaWx0ZXI6ICdGaWx0ZXJXaWRnZXQnLFxuICAgIGdhdWdlOiAnR2F1Z2VXaWRnZXQnLFxufTtcblxuZnVuY3Rpb24gRGFzaGJvYXJkQ2FudmFzKHtcbiAgICB3aWRnZXRzLFxuICAgIHdpZGdldERhdGEsXG4gICAgZmlsdGVycyxcbiAgICBtb2RlLFxuICAgIGxheW91dENvbHVtbnMgPSAxMixcbiAgICBvbldpZGdldENoYW5nZSxcbiAgICBvbldpZGdldFNlbGVjdCxcbiAgICBvbldpZGdldEFjdGlvbixcbiAgICBvbkRlbGV0ZVdpZGdldCxcbn0pIHtcbiAgICBjb25zdCBncmlkUmVmID0gdXNlUmVmKG51bGwpO1xuICAgIGNvbnN0IGdyaWRJbnN0YW5jZVJlZiA9IHVzZVJlZihudWxsKTtcblxuICAgIC8vIEluaXRpYWxpemUgR3JpZHN0YWNrXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFncmlkUmVmLmN1cnJlbnQgfHwgZ3JpZEluc3RhbmNlUmVmLmN1cnJlbnQpIHJldHVybjtcblxuICAgICAgICAvLyBDaGVjayBpZiBHcmlkU3RhY2sgaXMgYXZhaWxhYmxlXG4gICAgICAgIGlmICh0eXBlb2YgR3JpZFN0YWNrID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignR3JpZFN0YWNrIG5vdCBsb2FkZWQnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluaXRpYWxpemUgZ3JpZFxuICAgICAgICBjb25zdCBncmlkID0gR3JpZFN0YWNrLmluaXQoe1xuICAgICAgICAgICAgY29sdW1uOiBsYXlvdXRDb2x1bW5zLFxuICAgICAgICAgICAgY2VsbEhlaWdodDogODAsXG4gICAgICAgICAgICBtaW5Sb3c6IDEsXG4gICAgICAgICAgICBmbG9hdDogdHJ1ZSxcbiAgICAgICAgICAgIGFuaW1hdGU6IHRydWUsXG4gICAgICAgICAgICByZXNpemFibGU6IHtcbiAgICAgICAgICAgICAgICBoYW5kbGVzOiBtb2RlID09PSAnZWRpdCcgPyAnZSwgc2UsIHMsIHN3LCB3JyA6ICcnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRyYWdnYWJsZToge1xuICAgICAgICAgICAgICAgIGhhbmRsZTogJy5sdy13aWRnZXQtaGVhZGVyJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkaXNhYmxlRHJhZzogbW9kZSAhPT0gJ2VkaXQnLFxuICAgICAgICAgICAgZGlzYWJsZVJlc2l6ZTogbW9kZSAhPT0gJ2VkaXQnLFxuICAgICAgICB9LCBncmlkUmVmLmN1cnJlbnQpO1xuXG4gICAgICAgIGdyaWRJbnN0YW5jZVJlZi5jdXJyZW50ID0gZ3JpZDtcblxuICAgICAgICAvLyBIYW5kbGUgd2lkZ2V0IG1vdmVtZW50XG4gICAgICAgIGdyaWQub24oJ2RyYWdzdG9wJywgKGV2ZW50LCBlbCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGVsLmdyaWRzdGFja05vZGU7XG4gICAgICAgICAgICBpZiAobm9kZSAmJiBvbldpZGdldENoYW5nZSkge1xuICAgICAgICAgICAgICAgIG9uV2lkZ2V0Q2hhbmdlKG5vZGUuaWQsIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHsgeDogbm9kZS54LCB5OiBub2RlLnkgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSGFuZGxlIHdpZGdldCByZXNpemVcbiAgICAgICAgZ3JpZC5vbigncmVzaXplc3RvcCcsIChldmVudCwgZWwpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBlbC5ncmlkc3RhY2tOb2RlO1xuICAgICAgICAgICAgaWYgKG5vZGUgJiYgb25XaWRnZXRDaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICBvbldpZGdldENoYW5nZShub2RlLmlkLCB7XG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHsgdzogbm9kZS53LCBoOiBub2RlLmggfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGlmIChncmlkSW5zdGFuY2VSZWYuY3VycmVudCkge1xuICAgICAgICAgICAgICAgIGdyaWRJbnN0YW5jZVJlZi5jdXJyZW50LmRlc3Ryb3koZmFsc2UpO1xuICAgICAgICAgICAgICAgIGdyaWRJbnN0YW5jZVJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9LCBbbGF5b3V0Q29sdW1ucywgbW9kZV0pO1xuXG4gICAgLy8gVXBkYXRlIGdyaWQgbW9kZSAoZWRpdC92aWV3KVxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmICghZ3JpZEluc3RhbmNlUmVmLmN1cnJlbnQpIHJldHVybjtcblxuICAgICAgICBjb25zdCBncmlkID0gZ3JpZEluc3RhbmNlUmVmLmN1cnJlbnQ7XG4gICAgICAgIGlmIChtb2RlID09PSAnZWRpdCcpIHtcbiAgICAgICAgICAgIGdyaWQuZW5hYmxlTW92ZSh0cnVlKTtcbiAgICAgICAgICAgIGdyaWQuZW5hYmxlUmVzaXplKHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ3JpZC5lbmFibGVNb3ZlKGZhbHNlKTtcbiAgICAgICAgICAgIGdyaWQuZW5hYmxlUmVzaXplKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0sIFttb2RlXSk7XG5cbiAgICAvLyBSZW5kZXIgd2lkZ2V0IGNvbnRlbnRcbiAgICBjb25zdCByZW5kZXJXaWRnZXRDb250ZW50ID0gdXNlQ2FsbGJhY2soKHdpZGdldCkgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gd2lkZ2V0RGF0YVt3aWRnZXQuaWRdO1xuICAgICAgICBjb25zdCBjb21wb25lbnROYW1lID0gV0lER0VUX0NPTVBPTkVOVFNbd2lkZ2V0LnR5cGVdIHx8ICdLUElXaWRnZXQnO1xuXG4gICAgICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgICAgICAgd2lkZ2V0LFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgIGZpbHRlcnMsXG4gICAgICAgICAgICBtb2RlLFxuICAgICAgICAgICAgb25BY3Rpb246IG9uV2lkZ2V0QWN0aW9uLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFVzZSB0aGUgZ2xvYmFsbHkgcmVnaXN0ZXJlZCB3aWRnZXQgY29tcG9uZW50c1xuICAgICAgICBzd2l0Y2ggKGNvbXBvbmVudE5hbWUpIHtcbiAgICAgICAgICAgIGNhc2UgJ0tQSVdpZGdldCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDxLUElXaWRnZXQgey4uLnByb3BzfSAvPjtcbiAgICAgICAgICAgIGNhc2UgJ0NoYXJ0V2lkZ2V0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gPENoYXJ0V2lkZ2V0IHsuLi5wcm9wc30gLz47XG4gICAgICAgICAgICBjYXNlICdUYWJsZVdpZGdldCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDxUYWJsZVdpZGdldCB7Li4ucHJvcHN9IC8+O1xuICAgICAgICAgICAgY2FzZSAnRmlsdGVyV2lkZ2V0JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gPEZpbHRlcldpZGdldCB7Li4ucHJvcHN9IC8+O1xuICAgICAgICAgICAgY2FzZSAnR2F1Z2VXaWRnZXQnOlxuICAgICAgICAgICAgICAgIHJldHVybiA8R2F1Z2VXaWRnZXQgey4uLnByb3BzfSAvPjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwibHctd2lkZ2V0LXBsYWNlaG9sZGVyXCI+VW5rbm93biB3aWRnZXQgdHlwZTwvZGl2PjtcbiAgICAgICAgfVxuICAgIH0sIFt3aWRnZXREYXRhLCBmaWx0ZXJzLCBtb2RlLCBvbldpZGdldEFjdGlvbl0pO1xuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsdy1kYXNoYm9hcmQtY2FudmFzXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQtc3RhY2tcIiByZWY9e2dyaWRSZWZ9PlxuICAgICAgICAgICAgICAgIHt3aWRnZXRzLm1hcCh3aWRnZXQgPT4gKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9e3dpZGdldC5pZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdyaWQtc3RhY2staXRlbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBncy1pZD17d2lkZ2V0LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgZ3MteD17d2lkZ2V0LnBvc2l0aW9uPy54IHx8IDB9XG4gICAgICAgICAgICAgICAgICAgICAgICBncy15PXt3aWRnZXQucG9zaXRpb24/LnkgfHwgMH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGdzLXc9e3dpZGdldC5zaXplPy53IHx8IDR9XG4gICAgICAgICAgICAgICAgICAgICAgICBncy1oPXt3aWRnZXQuc2l6ZT8uaCB8fCAzfVxuICAgICAgICAgICAgICAgICAgICAgICAgZ3MtbWluLXc9e3dpZGdldC5taW5TaXplPy53IHx8IDJ9XG4gICAgICAgICAgICAgICAgICAgICAgICBncy1taW4taD17d2lkZ2V0Lm1pblNpemU/LmggfHwgMn1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkLXN0YWNrLWl0ZW0tY29udGVudFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgbHctd2lkZ2V0ICR7bW9kZSA9PT0gJ2VkaXQnID8gJ2x3LXdpZGdldC1lZGl0YWJsZScgOiAnJ31gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBvbldpZGdldFNlbGVjdCAmJiBvbldpZGdldFNlbGVjdCh3aWRnZXQuaWQpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsdy13aWRnZXQtaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJsdy13aWRnZXQtdGl0bGVcIj57d2lkZ2V0Lm5hbWV9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge21vZGUgPT09ICdlZGl0JyAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsdy13aWRnZXQtYWN0aW9uc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJsdy13aWRnZXQtYWN0aW9uLWJ0blwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25XaWRnZXRTZWxlY3QgJiYgb25XaWRnZXRTZWxlY3Qod2lkZ2V0LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1cIlNldHRpbmdzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtY29nXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibHctd2lkZ2V0LWFjdGlvbi1idG4gbHctd2lkZ2V0LWFjdGlvbi1kZWxldGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRGVsZXRlV2lkZ2V0ICYmIG9uRGVsZXRlV2lkZ2V0KHdpZGdldC5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJEZWxldGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS10cmFzaFwiPjwvaT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsdy13aWRnZXQtYm9keVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3JlbmRlcldpZGdldENvbnRlbnQod2lkZ2V0KX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAge3dpZGdldHMubGVuZ3RoID09PSAwICYmIChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImx3LWRhc2hib2FyZC1lbXB0eVwiPlxuICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS10YWNob21ldGVyIGZhLTR4IHRleHQtbXV0ZWRcIj48L2k+XG4gICAgICAgICAgICAgICAgICAgIDxoND5ObyB3aWRnZXRzIHlldDwvaDQ+XG4gICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtbXV0ZWRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHttb2RlID09PSAnZWRpdCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdDbGljayBcIkFkZCBXaWRnZXRcIiB0byBnZXQgc3RhcnRlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdUaGlzIGRhc2hib2FyZCBpcyBlbXB0eSd9XG4gICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICk7XG59XG5cbi8vIEV4cG9ydCBmb3IgdXNlIGluIERhc2hib2FyZEFwcFxud2luZG93LkRhc2hib2FyZENhbnZhcyA9IERhc2hib2FyZENhbnZhcztcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU07RUFBRUEsUUFBUTtFQUFFQyxTQUFTO0VBQUVDLE1BQU07RUFBRUM7QUFBWSxDQUFDLEdBQUdDLEtBQUs7O0FBRTFEO0FBQ0EsTUFBTUMsaUJBQWlCLEdBQUc7RUFDdEJDLEdBQUcsRUFBRSxXQUFXO0VBQ2hCQyxVQUFVLEVBQUUsYUFBYTtFQUN6QkMsU0FBUyxFQUFFLGFBQWE7RUFDeEJDLFVBQVUsRUFBRSxhQUFhO0VBQ3pCQyxTQUFTLEVBQUUs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