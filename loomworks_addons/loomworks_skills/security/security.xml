<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">

        <!-- Module Category -->
        <record id="module_category_skills" model="ir.module.category">
            <field name="name">Skills</field>
            <field name="description">AI Skill Framework for workflow automation</field>
            <field name="sequence">25</field>
        </record>

        <!-- Access Groups -->

        <!-- Skills User: Can execute skills and view own executions -->
        <record id="group_skills_user" model="res.groups">
            <field name="name">Skills User</field>
            <field name="category_id" ref="module_category_skills"/>
            <field name="comment">Can execute skills and view own execution history</field>
        </record>

        <!-- Skills Creator: Can create and manage skills -->
        <record id="group_skills_creator" model="res.groups">
            <field name="name">Skills Creator</field>
            <field name="category_id" ref="module_category_skills"/>
            <field name="implied_ids" eval="[(4, ref('group_skills_user'))]"/>
            <field name="comment">Can create, edit, and manage skills</field>
        </record>

        <!-- Skills Manager: Full access to all skills features -->
        <record id="group_skills_manager" model="res.groups">
            <field name="name">Skills Manager</field>
            <field name="category_id" ref="module_category_skills"/>
            <field name="implied_ids" eval="[(4, ref('group_skills_creator'))]"/>
            <field name="comment">Full access to skills management including built-in skills</field>
        </record>

        <!-- Record Rules -->

        <!-- Users can see active and own draft skills -->
        <record id="rule_skill_user_read" model="ir.rule">
            <field name="name">Skill: User Read</field>
            <field name="model_id" ref="model_loomworks_skill"/>
            <field name="domain_force">[
                '|',
                ('state', '=', 'active'),
                '&amp;', ('state', '=', 'draft'), ('owner_id', '=', user.id)
            ]</field>
            <field name="groups" eval="[(4, ref('group_skills_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Creators can manage their own skills -->
        <record id="rule_skill_creator_own" model="ir.rule">
            <field name="name">Skill: Creator Own Skills</field>
            <field name="model_id" ref="model_loomworks_skill"/>
            <field name="domain_force">[('owner_id', '=', user.id), ('is_builtin', '=', False)]</field>
            <field name="groups" eval="[(4, ref('group_skills_creator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Managers can manage all skills -->
        <record id="rule_skill_manager_all" model="ir.rule">
            <field name="name">Skill: Manager All Skills</field>
            <field name="model_id" ref="model_loomworks_skill"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_skills_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Execution records - users see their own -->
        <record id="rule_execution_user_own" model="ir.rule">
            <field name="name">Execution: User Own</field>
            <field name="model_id" ref="model_loomworks_skill_execution"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_skills_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Managers see all executions -->
        <record id="rule_execution_manager_all" model="ir.rule">
            <field name="name">Execution: Manager All</field>
            <field name="model_id" ref="model_loomworks_skill_execution"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_skills_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Recordings - users see their own -->
        <record id="rule_recording_user_own" model="ir.rule">
            <field name="name">Recording: User Own</field>
            <field name="model_id" ref="model_loomworks_skill_recording"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_skills_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

    </data>
</odoo>
